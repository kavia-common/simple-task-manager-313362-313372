{"is_source_file": true, "format": "Python", "description": "This file implements a RESTful API backend for a simple Todo application using FastAPI. It defines data models, database connection helpers with SQLite, and routes for CRUD operations on tasks, including health checks, task creation, retrieval, update, deletion, and toggling task completion. It also sets up CORS middleware and initializes the database schema on startup.", "external_files": ["../../data/todo.db"], "external_methods": ["os.path.join", "os.environ.get", "os.makedirs", "sqlite3.connect"], "published": ["app"], "classes": [{"name": "Task", "description": "Represents a todo task, including ID, title, completion status, and creation timestamp."}, {"name": "TaskCreate", "description": "Request model for creating a new task, includes task title."}, {"name": "TaskUpdate", "description": "Request model for updating an existing task, optional fields for title and completion status."}], "methods": [{"name": "Task _row_to_task(row: sqlite3.Row)", "description": "Converts a SQLite row into a Task object.", "scope": "", "scopeKind": ""}, {"name": "sqlite3.Row _fetch_task_or_404(conn: sqlite3.Connection, task_id: int)", "description": "Fetches a task by ID or raises a 404 HTTPException.", "scope": "", "scopeKind": ""}, {"name": "Dict[str,str] health_check()", "description": "Returns a health message indicating the service is healthy.", "scope": "", "scopeKind": ""}, {"name": "List[Task] list_tasks()", "description": "Retrieves all tasks from the database in descending order.", "scope": "", "scopeKind": ""}, {"name": "Task create_task(payload: TaskCreate)", "description": "Creates a new task and returns it.", "scope": "", "scopeKind": ""}, {"name": "Task get_task( task_id: int = Path(..., ge=1, description=\"Task ID to fetch.\"), )", "description": "Fetches a single task by ID.", "scope": "", "scopeKind": ""}, {"name": "Task update_task( payload: TaskUpdate, task_id: int = Path(..., ge=1, description=\"Task ID to update.\"), )", "description": "Updates an existing task's title and/or completion status.", "scope": "", "scopeKind": ""}, {"name": "None delete_task( task_id: int = Path(..., ge=1, description=\"Task ID to delete.\"), )", "description": "Deletes a task by ID.", "scope": "", "scopeKind": ""}, {"name": "Task toggle_task_completion( task_id: int = Path(..., ge=1, description=\"Task ID to toggle completion.\"), )", "description": "Toggles the completion status of a task.", "scope": "", "scopeKind": ""}, {"name": "Generator[sqlite3.Connection,None,None] _db()", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "None _ensure_parent_dir(db_path: str)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "sqlite3.Connection _get_connection()", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "None _init_db()", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "None _on_startup()", "scope": "", "scopeKind": "", "description": "unavailable"}], "calls": ["os.path.join", "os.environ.get", "os.makedirs", "sqlite3.connect", "conn.execute", "conn.row_factory", "conn.commit", "conn.close", "conn.execute", "conn.execute", "conn.execute", "conn.execute", "conn.execute", "conn.execute"], "search-terms": ["FastAPI", "SQLite", "task CRUD", "TaskCreate", "TaskUpdate", "toggle_task_completion", "CORS", "health check"], "state": 2, "file_id": 3, "knowledge_revision": 11, "git_revision": "6ca62e25463c2ebf84d35822a531057a7c01bfc8", "revision_history": [{"8": "f4345bde82b470ebca32d50833990a2644d77373"}, {"10": "6ca62e25463c2ebf84d35822a531057a7c01bfc8"}, {"11": "6ca62e25463c2ebf84d35822a531057a7c01bfc8"}], "ctags": [{"_type": "tag", "name": "ALLOWED_ORIGINS", "path": "/home/kavia/workspace/code-generation/simple-task-manager-313362-313372/todo_backend/src/api/main.py", "pattern": "/^ALLOWED_ORIGINS = [$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "DB_PATH", "path": "/home/kavia/workspace/code-generation/simple-task-manager-313362-313372/todo_backend/src/api/main.py", "pattern": "/^DB_PATH = os.environ.get(\"SQLITE_DB\", DEFAULT_DB_PATH)$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "DEFAULT_DB_PATH", "path": "/home/kavia/workspace/code-generation/simple-task-manager-313362-313372/todo_backend/src/api/main.py", "pattern": "/^DEFAULT_DB_PATH = os.path.join(os.path.dirname(__file__), \"..\", \"..\", \"data\", \"todo.db\")$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "Task", "path": "/home/kavia/workspace/code-generation/simple-task-manager-313362-313372/todo_backend/src/api/main.py", "pattern": "/^class Task(BaseModel):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "TaskCreate", "path": "/home/kavia/workspace/code-generation/simple-task-manager-313362-313372/todo_backend/src/api/main.py", "pattern": "/^class TaskCreate(BaseModel):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "TaskUpdate", "path": "/home/kavia/workspace/code-generation/simple-task-manager-313362-313372/todo_backend/src/api/main.py", "pattern": "/^class TaskUpdate(BaseModel):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "_db", "path": "/home/kavia/workspace/code-generation/simple-task-manager-313362-313372/todo_backend/src/api/main.py", "pattern": "/^def _db() -> Generator[sqlite3.Connection, None, None]:$/", "language": "Python", "typeref": "typename:Generator[sqlite3.Connection,None,None]", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "_ensure_parent_dir", "path": "/home/kavia/workspace/code-generation/simple-task-manager-313362-313372/todo_backend/src/api/main.py", "pattern": "/^def _ensure_parent_dir(db_path: str) -> None:$/", "language": "Python", "typeref": "typename:None", "kind": "function", "signature": "(db_path: str)"}, {"_type": "tag", "name": "_fetch_task_or_404", "path": "/home/kavia/workspace/code-generation/simple-task-manager-313362-313372/todo_backend/src/api/main.py", "pattern": "/^def _fetch_task_or_404(conn: sqlite3.Connection, task_id: int) -> sqlite3.Row:$/", "language": "Python", "typeref": "typename:sqlite3.Row", "kind": "function", "signature": "(conn: sqlite3.Connection, task_id: int)"}, {"_type": "tag", "name": "_get_connection", "path": "/home/kavia/workspace/code-generation/simple-task-manager-313362-313372/todo_backend/src/api/main.py", "pattern": "/^def _get_connection() -> sqlite3.Connection:$/", "language": "Python", "typeref": "typename:sqlite3.Connection", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "_init_db", "path": "/home/kavia/workspace/code-generation/simple-task-manager-313362-313372/todo_backend/src/api/main.py", "pattern": "/^def _init_db() -> None:$/", "language": "Python", "typeref": "typename:None", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "_on_startup", "path": "/home/kavia/workspace/code-generation/simple-task-manager-313362-313372/todo_backend/src/api/main.py", "pattern": "/^def _on_startup() -> None:$/", "language": "Python", "typeref": "typename:None", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "_row_to_task", "path": "/home/kavia/workspace/code-generation/simple-task-manager-313362-313372/todo_backend/src/api/main.py", "pattern": "/^def _row_to_task(row: sqlite3.Row) -> Task:$/", "language": "Python", "typeref": "typename:Task", "kind": "function", "signature": "(row: sqlite3.Row)"}, {"_type": "tag", "name": "app", "path": "/home/kavia/workspace/code-generation/simple-task-manager-313362-313372/todo_backend/src/api/main.py", "pattern": "/^app = FastAPI($/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "completed", "path": "/home/kavia/workspace/code-generation/simple-task-manager-313362-313372/todo_backend/src/api/main.py", "pattern": "/^    completed: Optional[bool] = Field($/", "language": "Python", "typeref": "typename:Optional[bool]", "kind": "variable", "scope": "TaskUpdate", "scopeKind": "class"}, {"_type": "tag", "name": "completed", "path": "/home/kavia/workspace/code-generation/simple-task-manager-313362-313372/todo_backend/src/api/main.py", "pattern": "/^    completed: bool = Field(..., description=\"Whether the task is completed.\")$/", "language": "Python", "typeref": "typename:bool", "kind": "variable", "scope": "Task", "scopeKind": "class"}, {"_type": "tag", "name": "create_task", "path": "/home/kavia/workspace/code-generation/simple-task-manager-313362-313372/todo_backend/src/api/main.py", "pattern": "/^def create_task(payload: TaskCreate) -> Task:$/", "language": "Python", "typeref": "typename:Task", "kind": "function", "signature": "(payload: TaskCreate)"}, {"_type": "tag", "name": "created_at", "path": "/home/kavia/workspace/code-generation/simple-task-manager-313362-313372/todo_backend/src/api/main.py", "pattern": "/^    created_at: str = Field(..., description=\"ISO8601 creation timestamp.\")$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "Task", "scopeKind": "class"}, {"_type": "tag", "name": "delete_task", "path": "/home/kavia/workspace/code-generation/simple-task-manager-313362-313372/todo_backend/src/api/main.py", "pattern": "/^def delete_task($/", "language": "Python", "typeref": "typename:None", "kind": "function", "signature": "( task_id: int = Path(..., ge=1, description=\"Task ID to delete.\"), )"}, {"_type": "tag", "name": "get_task", "path": "/home/kavia/workspace/code-generation/simple-task-manager-313362-313372/todo_backend/src/api/main.py", "pattern": "/^def get_task($/", "language": "Python", "typeref": "typename:Task", "kind": "function", "signature": "( task_id: int = Path(..., ge=1, description=\"Task ID to fetch.\"), )"}, {"_type": "tag", "name": "health_check", "path": "/home/kavia/workspace/code-generation/simple-task-manager-313362-313372/todo_backend/src/api/main.py", "pattern": "/^def health_check() -> Dict[str, str]:$/", "language": "Python", "typeref": "typename:Dict[str,str]", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "id", "path": "/home/kavia/workspace/code-generation/simple-task-manager-313362-313372/todo_backend/src/api/main.py", "pattern": "/^    id: int = Field(..., description=\"Task ID.\")$/", "language": "Python", "typeref": "typename:int", "kind": "variable", "scope": "Task", "scopeKind": "class"}, {"_type": "tag", "name": "list_tasks", "path": "/home/kavia/workspace/code-generation/simple-task-manager-313362-313372/todo_backend/src/api/main.py", "pattern": "/^def list_tasks() -> List[Task]:$/", "language": "Python", "typeref": "typename:List[Task]", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "openapi_tags", "path": "/home/kavia/workspace/code-generation/simple-task-manager-313362-313372/todo_backend/src/api/main.py", "pattern": "/^openapi_tags = [$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "title", "path": "/home/kavia/workspace/code-generation/simple-task-manager-313362-313372/todo_backend/src/api/main.py", "pattern": "/^    title: Optional[str] = Field($/", "language": "Python", "typeref": "typename:Optional[str]", "kind": "variable", "scope": "TaskUpdate", "scopeKind": "class"}, {"_type": "tag", "name": "title", "path": "/home/kavia/workspace/code-generation/simple-task-manager-313362-313372/todo_backend/src/api/main.py", "pattern": "/^    title: str = Field(..., description=\"Task title.\")$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "Task", "scopeKind": "class"}, {"_type": "tag", "name": "title", "path": "/home/kavia/workspace/code-generation/simple-task-manager-313362-313372/todo_backend/src/api/main.py", "pattern": "/^    title: str = Field(..., min_length=1, max_length=200, description=\"Task title.\")$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "TaskCreate", "scopeKind": "class"}, {"_type": "tag", "name": "toggle_task_completion", "path": "/home/kavia/workspace/code-generation/simple-task-manager-313362-313372/todo_backend/src/api/main.py", "pattern": "/^def toggle_task_completion($/", "language": "Python", "typeref": "typename:Task", "kind": "function", "signature": "( task_id: int = Path(..., ge=1, description=\"Task ID to toggle completion.\"), )"}, {"_type": "tag", "name": "update_task", "path": "/home/kavia/workspace/code-generation/simple-task-manager-313362-313372/todo_backend/src/api/main.py", "pattern": "/^def update_task($/", "language": "Python", "typeref": "typename:Task", "kind": "function", "signature": "( payload: TaskUpdate, task_id: int = Path(..., ge=1, description=\"Task ID to update.\"), )"}], "hash": "6a57a293836c3f578c85695ccd01c454", "format-version": 4, "code-base-name": "todo_backend", "filename": "todo_backend/src/api/main.py", "fields": [{"name": "ALLOWED_ORIGINS = [", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "DB_PATH = os.environ.get(\"SQLITE_DB\", DEFAULT_DB_PATH)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "DEFAULT_DB_PATH = os.path.join(os.path.dirname(__file__), \"..\", \"..\", \"data\", \"todo.db\")", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "app = FastAPI(", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "Optional[bool] completed", "scope": "TaskUpdate", "scopeKind": "class", "description": "unavailable"}, {"name": "bool completed", "scope": "Task", "scopeKind": "class", "description": "unavailable"}, {"name": "str created_at", "scope": "Task", "scopeKind": "class", "description": "unavailable"}, {"name": "int id", "scope": "Task", "scopeKind": "class", "description": "unavailable"}, {"name": "openapi_tags = [", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "Optional[str] title", "scope": "TaskUpdate", "scopeKind": "class", "description": "unavailable"}, {"name": "str title", "scope": "Task", "scopeKind": "class", "description": "unavailable"}]}